#!/bin/sh

# Dependencies: ip

dwm_vpn() {
    # Handle click actions
    case "$BLOCK_BUTTON" in
        1)
            if ip addr show tun0 >/dev/null 2>&1; then
                IP=$(ip -4 addr show tun0 | awk '/inet / {print $2}' | cut -d/ -f1)
                ROUTES=$(ip route show dev tun0 2>/dev/null | head -n 5)
                notify-send "VPN Details" "Interface: tun0\nIP: $IP\n\nRoutes:\n$ROUTES"
            else
                notify-send "VPN" "Not connected"
            fi
            exit 0
            ;;
    esac

    # Check if tun0 exists and has an IP
    if ip addr show tun0 >/dev/null 2>&1; then
        IP=$(ip -4 addr show tun0 | awk '/inet / {print $2}' | cut -d/ -f1)
        if [ -n "$IP" ]; then
            printf "ðŸ”’ %s" "$IP"
        fi
    fi
}

dwm_vpn
