#!/bin/sh

# A dwm_status function that displays the status of countdown.sh
# Joe Standring <git@joestandring.com>
# GNU GPLv3

# Dependencies: https://github.com/joestandring/countdown

# Handle click actions
case "$BLOCK_BUTTON" in
    1)
        # Cancel the countdown by removing its temp file
        for f in /tmp/countdown.*; do
            if [ -e "$f" ]; then
                rm -f "$f"
                notify-send "Countdown" "Cancelled"
            fi
        done
        exit 0
        ;;
esac

dwm_countdown () {
    for f in /tmp/countdown.*; do
        if [ -e "$f" ]; then
            printf "%s" "$SEP1"
            if [ "$IDENTIFIER" = "unicode" ]; then
                printf "‚è≥ %s" "$(tail -1 /tmp/countdown.*)"
            else
                printf "CDN %s" "$(tail -1 /tmp/countdown.*)"
            fi
            printf "%s\n" "$SEP2"

            break
        fi
    done
}

dwm_countdown
